import{B as c}from"./D0_loxAU.js";const i=()=>{const r=c();return{authFetch:async(o,a={})=>{let{data:{session:e}}=await r.auth.getSession();if(!(e!=null&&e.access_token)){console.log("[authFetch] No session found, attempting refresh...");const{data:t,error:s}=await r.auth.refreshSession();if(s)throw console.error("[authFetch] Session refresh failed:",s.message),new Error("Not authenticated - please login again");e=t.session}if(!(e!=null&&e.access_token))throw console.error("[authFetch] No access token available after refresh attempt"),new Error("Not authenticated - please login again");console.log("[authFetch] Making request to:",o,"Method:",a.method||"GET");const h={...a.headers,Authorization:`Bearer ${e.access_token}`};try{const t=await $fetch(o,{method:a.method||"GET",body:a.body,headers:h});return console.log("[authFetch] Request successful"),t}catch(t){throw console.error("[authFetch] Request failed:",t.message||t),t}}}};export{i as u};
