import{d as Re,h as Ve,i as ye,g as ue,r as c,C as Ut,c as d,b as a,a as t,l as v,j as g,w as r,z as Ae,f as s,s as z,F as I,k as N,t as m,x as Tt,e as f,m as F,D as Ee,p as ce,T as K,_ as Le,o as i,E as Oe,n as Ne,y as Be}from"./D0_loxAU.js";import{_ as St}from"./2t6NhyjD.js";import{_ as jt,a as It,b as Mt,c as Pt,d as At,e as Et}from"./8Jew3ux9.js";import{_ as Nt}from"./CXcBp2lP.js";import{a as Bt,u as He}from"./DfhhxIwp.js";import"./oVxJKGu7.js";import"./BNf5BS2b.js";import"./B5rdlIOA.js";import"./CxRmHzWs.js";const Rt={key:0,class:"fixed inset-0 z-40 bg-primary/10 backdrop-blur-sm flex items-center justify-center pointer-events-none"},Vt={class:"bg-card border-2 border-dashed border-primary rounded-xl p-12 text-center shadow-2xl"},Lt={key:0,class:"fixed bottom-6 left-1/2 -translate-x-1/2 z-30 bg-card border rounded-lg shadow-lg px-4 py-3 flex items-center gap-4 max-w-[90vw] overflow-x-auto"},Ot={class:"text-sm font-medium whitespace-nowrap"},Ht={class:"flex gap-2"},Kt={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6"},qt={class:"flex items-center gap-1 overflow-x-auto no-scrollbar mask-gradient-right"},Jt={class:"flex items-center text-sm font-medium text-muted-foreground whitespace-nowrap"},Gt=["onClick"],Qt={class:"flex gap-2 shrink-0"},Wt={key:0,class:"bg-card border rounded-lg p-4"},Xt={class:"flex items-center justify-between mb-2"},Yt={class:"text-sm text-muted-foreground"},Zt={class:"w-full bg-muted rounded-full h-2"},es={key:1,class:"rounded-md border bg-card p-8"},ts={class:"flex flex-col items-center justify-center gap-2 text-muted-foreground"},ss={key:2,class:"rounded-md border border-destructive/50 bg-destructive/10 p-8"},ls={class:"flex flex-col items-center justify-center gap-2 text-destructive"},as={class:"text-sm"},os={class:"flex flex-col items-center justify-center gap-3 text-muted-foreground"},ns={key:4,class:"rounded-md border bg-card text-card-foreground shadow-sm"},is=["checked"],rs=["checked","onChange"],ds={class:"flex flex-col min-w-0"},us={class:"text-sm font-semibold text-foreground truncate group-hover:text-primary transition-colors"},cs={class:"text-xs text-muted-foreground md:hidden flex items-center gap-1"},ms={class:"flex items-center justify-end gap-1 opacity-100 lg:opacity-0 lg:group-hover:opacity-100 transition-opacity"},fs={class:"text-center text-xs text-muted-foreground"},ps={class:"bg-card rounded-lg shadow-lg w-full max-w-sm p-6 m-4"},vs={class:"space-y-4"},gs={class:"flex gap-2"},xs={class:"bg-card rounded-lg shadow-lg w-full max-w-sm p-6 m-4"},hs={class:"space-y-4"},bs={class:"flex gap-2"},ys={class:"bg-card rounded-lg shadow-lg w-full max-w-md p-6 m-4"},ws={class:"text-lg font-semibold mb-4"},_s={class:"space-y-4"},ks={class:"border rounded-lg max-h-64 overflow-auto"},Cs={class:"sticky top-0 bg-card border-b p-2 flex items-center gap-2"},$s={class:"text-sm text-muted-foreground truncate"},Fs={key:0,class:"p-4 text-center text-muted-foreground"},Ds={key:1,class:"p-4 text-center text-muted-foreground text-sm"},zs={key:2},Us=["onClick"],Ts={class:"text-sm truncate"},Ss={class:"flex gap-2"},js={class:"bg-card rounded-lg shadow-lg w-full max-w-md p-6 m-4"},Is={class:"text-lg font-semibold mb-4"},Ms={class:"space-y-4"},Ps={class:"border rounded-lg max-h-64 overflow-auto"},As={class:"sticky top-0 bg-card border-b p-2 flex items-center gap-2"},Es={class:"text-sm text-muted-foreground truncate"},Ns={key:0,class:"p-4 text-center text-muted-foreground"},Bs={key:1,class:"p-4 text-center text-muted-foreground text-sm"},Rs={key:2},Vs=["onClick"],Ls={class:"text-sm truncate"},Os={class:"flex gap-2"},Hs={class:"bg-card rounded-lg shadow-lg w-full max-w-md p-6 m-4"},Ks={class:"text-lg font-semibold mb-4 flex items-center gap-2"},qs={key:0,class:"flex flex-col items-center justify-center py-8 text-muted-foreground gap-2"},Js={key:1,class:"space-y-4"},Gs={class:"text-sm text-muted-foreground"},Qs={class:"font-medium text-foreground"},Ws={class:"grid grid-cols-4 gap-2"},Xs=["onClick"],Ys={class:"flex gap-2"},Zs={key:2,class:"space-y-4"},el={class:"font-medium"},tl={class:"flex gap-2"},sl=["value"],ll={class:"text-xs text-muted-foreground"},al={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"},ol={class:"bg-card w-full max-w-sm rounded-lg shadow-lg border p-6"},nl={class:"flex items-center gap-3 mb-4"},il={class:"p-2 rounded-full bg-destructive/10"},rl={class:"font-semibold text-lg text-foreground"},dl={class:"text-muted-foreground mb-6"},ul={class:"flex gap-3 justify-end"},cl=Re({__name:"FileBrowser",props:{accountId:{}},setup(we){const _=we,{currentPath:k,files:C,isLoading:y,error:q,selectedIds:T,selectedFiles:w,toggleSelect:p,selectAll:D,clearSelection:B,isSelected:x,isAllSelected:_e,fetchFiles:R,navigateToFolder:Ke,navigateUp:qe,getDownloadLink:Je,createFolder:Ge,deleteItem:Qe,bulkDelete:We,renameItem:Xe,bulkMove:Ye,bulkCopy:Ze,bulkDownload:et,formatFileSize:ke,formatDate:Ce,getFileIcon:tt,getIconColor:st,getFolders:$e}=Bt(_.accountId),{activeAccountId:Fe}=He();Ve(()=>{R("")}),_.accountId||ye(Fe,()=>{R("",!0)});const me=ue(()=>k.value?k.value.split("/").filter(Boolean):[]),lt=l=>{const n="/"+me.value.slice(0,l+1).join("/");R(n)},at=async l=>{if(l.type==="folder")Ke(l.path);else{const e=await Je(l.path);e&&window.open(e,"_blank")}},J=c(!1);let Z=0;const ot=l=>{var e;Z++,(e=l.dataTransfer)!=null&&e.types.includes("Files")&&(J.value=!0)},nt=l=>{var e;(e=l.dataTransfer)!=null&&e.types.includes("Files")&&(l.dataTransfer.dropEffect="copy")},it=()=>{Z--,Z===0&&(J.value=!1)},rt=async l=>{var n;J.value=!1,Z=0;const e=(n=l.dataTransfer)==null?void 0:n.files;e!=null&&e.length&&await Te(e)},De=c(null),M=c(!1),G=c(0),V=c(0),ze=ue(()=>V.value===0?"":`${G.value}/${V.value}`),dt=ue(()=>V.value===0?0:Math.round(G.value/V.value*100)),Ue=()=>{var l;(l=De.value)==null||l.click()},ut=async l=>{var n;const e=l.target;(n=e.files)!=null&&n.length&&(await Te(e.files),e.value="")},Te=async l=>{M.value=!0,G.value=0,V.value=l.length;try{const e=await $fetch("/api/dropbox/upload-session",{query:{path:k.value}});for(const n of Array.from(l)){const u=k.value?`${k.value}/${n.name}`:`/${n.name}`,U=await fetch("https://content.dropboxapi.com/2/files/upload",{method:"POST",headers:{Authorization:`Bearer ${e.accessToken}`,"Dropbox-API-Arg":JSON.stringify({path:u,mode:"add",autorename:!0,mute:!1}),"Content-Type":"application/octet-stream"},body:n});if(!U.ok){const de=await U.json();throw new Error(de.error_summary||`Failed to upload ${n.name}`)}G.value++}await R(k.value)}catch(e){console.error("Upload error:",e),alert(e.message||"Upload failed")}finally{M.value=!1,G.value=0,V.value=0}},Q=c(!1),P=c(""),ee=c(!1),Se=async()=>{if(P.value){ee.value=!0;try{await Ge(P.value),Q.value=!1,P.value=""}catch(l){alert(l.message||"Failed to create folder")}finally{ee.value=!1}}},W=c(!1),te=c(null),S=c(""),se=c(!1),ct=l=>{te.value=l,S.value=l.name,W.value=!0},je=async()=>{if(!(!S.value||!te.value)){se.value=!0;try{await Xe(te.value.path,S.value),W.value=!1,te.value=null,S.value=""}catch(l){alert(l.message||"Failed to rename")}finally{se.value=!1}}},b=Ut({isOpen:!1,title:"Confirm",message:"",confirmText:"Delete",resolve:l=>{}}),Ie=l=>new Promise(e=>{b.title=l.title||"Confirm",b.message=l.message,b.confirmText=l.confirmText||"Delete",b.resolve=e,b.isOpen=!0}),mt=async l=>{const e=l.type==="folder"?`Delete folder "${l.name}" and all its contents?`:`Delete "${l.name}"?`;if(await Ie({title:"Delete",message:e}))try{await Qe(l.path)}catch(u){console.error("Delete error:",u)}},ft=async()=>{const l=T.value.size;if(await Ie({title:"Delete Items",message:`Delete ${l} items? This cannot be undone.`,confirmText:"Delete All"}))try{const n=w.value.map(u=>u.path);await We(n)}catch(n){console.error("Bulk delete error:",n)}},L=c(!1),A=c(""),fe=c([]),pe=c(!1),le=c(!1);ye(L,async l=>{l&&(A.value="",await ve(""))});const ve=async l=>{pe.value=!0;try{fe.value=await $e(l)}finally{pe.value=!1}},pt=async l=>{A.value=l,await ve(l)},vt=async()=>{const l=A.value.split("/");l.pop();const e=l.join("/");A.value=e,await ve(e)},gt=async()=>{le.value=!0;try{const l=w.value.map(e=>e.path);await Ye(l,A.value),L.value=!1}catch(l){alert(l.message||"Failed to move items")}finally{le.value=!1}},X=c(!1),xt=async()=>{const l=w.value.filter(e=>e.type==="file").map(e=>e.path);if(l.length===0){alert("Please select at least one file to download. Folders cannot be downloaded directly.");return}X.value=!0;try{await et(l)}catch(e){alert(e.message||"Failed to download files")}finally{X.value=!1}},O=c(!1),E=c(""),ge=c([]),xe=c(!1),ae=c(!1);ye(O,async l=>{l&&(E.value="",await he(""))});const he=async l=>{xe.value=!0;try{ge.value=await $e(l)}finally{xe.value=!1}},ht=async l=>{E.value=l,await he(l)},bt=async()=>{const l=E.value.split("/");l.pop();const e=l.join("/");E.value=e,await he(e)},yt=async()=>{ae.value=!0;try{const l=w.value.map(e=>e.path);await Ze(l,E.value),O.value=!1}catch(l){alert(l.message||"Failed to copy items")}finally{ae.value=!1}},Y=c(!1),j=c(null),$=c(null),oe=c(7),ne=c(!1),ie=c(!1),wt=[{days:10,unit:"seconds",label:"10 Sec"},{days:1,unit:"days",label:"1 Day"},{days:3,unit:"days",label:"3 Days"},{days:7,unit:"days",label:"7 Days"},{days:30,unit:"days",label:"1 Month"}],be=c(!1),_t=async l=>{j.value=l,$.value=null,oe.value=7,re.value="days",Y.value=!0,await kt()},kt=async()=>{if(j.value){be.value=!0;try{const l=await $fetch("/api/shares",{query:{accountId:_.accountId||Fe.value,filePath:j.value.path,findOne:"true"}});l.shares&&l.shares.length>0&&($.value={...l.shares[0],isExisting:!0})}catch(l){console.warn("Failed to check existing share:",l)}finally{be.value=!1}}},re=c("days"),Ct=async()=>{var l;if(j.value){ne.value=!0;try{const e=await $fetch("/api/shares/create",{method:"POST",body:{filePath:j.value.path,fileName:j.value.name,fileId:j.value.id,expirationDays:oe.value,expirationUnit:re.value}});e.success&&($.value=e.share)}catch(e){console.error("Create share failed:",e),alert(((l=e.data)==null?void 0:l.message)||e.message||"Failed to create share link")}finally{ne.value=!1}}},$t=async()=>{$.value&&(await navigator.clipboard.writeText($.value.url),ie.value=!0,setTimeout(()=>ie.value=!1,2e3))};return(l,e)=>{var Pe;const n=Le,u=St,U=Pt,de=Mt,Ft=It,H=Et,Dt=At,zt=jt,Me=Nt;return i(),d("div",{class:"space-y-4",onDragenter:F(ot,["prevent"]),onDragover:F(nt,["prevent"]),onDragleave:F(it,["prevent"]),onDrop:F(rt,["prevent"])},[a(Ae,{name:"fade"},{default:r(()=>[s(J)?(i(),d("div",Rt,[t("div",Vt,[a(n,{name:"lucide:upload-cloud",class:"h-16 w-16 mx-auto mb-4 text-primary animate-bounce"}),e[23]||(e[23]=t("p",{class:"text-xl font-semibold text-primary"},"Drop files here to upload",-1)),e[24]||(e[24]=t("p",{class:"text-sm text-muted-foreground mt-2"},"Files will be uploaded to current folder",-1))])])):v("",!0)]),_:1}),a(Ae,{name:"slide"},{default:r(()=>[s(T).size>0?(i(),d("div",Lt,[t("span",Ot,m(s(T).size)+" selected ",1),e[30]||(e[30]=t("div",{class:"h-4 w-px bg-border shrink-0"},null,-1)),t("div",Ht,[a(u,{variant:"outline",size:"sm",onClick:xt,disabled:s(X)},{default:r(()=>[a(n,{name:s(X)?"lucide:loader-2":"lucide:download",class:z(["mr-2 h-4 w-4",s(X)&&"animate-spin"])},null,8,["name","class"]),e[25]||(e[25]=t("span",{class:"hidden sm:inline"},"Download",-1))]),_:1},8,["disabled"]),a(u,{variant:"outline",size:"sm",onClick:e[0]||(e[0]=o=>O.value=!0)},{default:r(()=>[a(n,{name:"lucide:copy",class:"mr-2 h-4 w-4"}),e[26]||(e[26]=t("span",{class:"hidden sm:inline"},"Copy",-1))]),_:1}),a(u,{variant:"outline",size:"sm",onClick:e[1]||(e[1]=o=>L.value=!0)},{default:r(()=>[a(n,{name:"lucide:folder-input",class:"mr-2 h-4 w-4"}),e[27]||(e[27]=t("span",{class:"hidden sm:inline"},"Move",-1))]),_:1}),a(u,{variant:"outline",size:"sm",class:"text-destructive hover:text-destructive",onClick:ft},{default:r(()=>[a(n,{name:"lucide:trash-2",class:"mr-2 h-4 w-4"}),e[28]||(e[28]=t("span",{class:"hidden sm:inline"},"Delete",-1))]),_:1})]),e[31]||(e[31]=t("div",{class:"h-4 w-px bg-border shrink-0"},null,-1)),a(u,{variant:"ghost",size:"icon",class:"sm:hidden",onClick:s(B)},{default:r(()=>[a(n,{name:"lucide:x",class:"h-4 w-4"})]),_:1},8,["onClick"]),a(u,{variant:"ghost",size:"sm",class:"hidden sm:flex",onClick:s(B)},{default:r(()=>[a(n,{name:"lucide:x",class:"mr-2 h-4 w-4"}),e[29]||(e[29]=f(" Cancel ",-1))]),_:1},8,["onClick"])])):v("",!0)]),_:1}),t("div",Kt,[t("div",qt,[s(k)?(i(),g(u,{key:0,variant:"ghost",size:"icon",onClick:s(qe),class:"h-8 w-8 shrink-0"},{default:r(()=>[a(n,{name:"lucide:arrow-left",class:"h-4 w-4"})]),_:1},8,["onClick"])):v("",!0),t("nav",Jt,[t("button",{onClick:e[2]||(e[2]=o=>s(R)("")),class:z(["hover:text-foreground hover:bg-muted px-2 py-1 rounded-md transition-colors",s(k)?"":"text-foreground font-semibold bg-muted/50"])}," Home ",2),(i(!0),d(I,null,N(s(me),(o,h)=>(i(),d(I,{key:h},[a(n,{name:"lucide:chevron-right",class:"h-4 w-4 mx-0.5 text-muted-foreground/50"}),t("button",{onClick:jl=>lt(h),class:z(["hover:text-foreground hover:bg-muted px-2 py-1 rounded-md transition-colors",h===s(me).length-1?"text-foreground font-semibold bg-muted/50":""])},m(o),11,Gt)],64))),128))])]),t("div",Qt,[a(u,{variant:"outline",size:"sm",onClick:Ue,disabled:s(M)},{default:r(()=>[a(n,{name:s(M)?"lucide:loader-2":"lucide:upload",class:z(["mr-2 h-4 w-4",s(M)&&"animate-spin"])},null,8,["name","class"]),f(" "+m(s(M)?`Uploading ${s(ze)}`:"Upload"),1)]),_:1},8,["disabled"]),t("input",{ref_key:"fileInput",ref:De,type:"file",multiple:"",class:"hidden",onChange:ut},null,544),a(u,{variant:"outline",size:"sm",onClick:e[3]||(e[3]=o=>Q.value=!0)},{default:r(()=>[a(n,{name:"lucide:folder-plus",class:"mr-2 h-4 w-4"}),e[32]||(e[32]=f(" New Folder ",-1))]),_:1})])]),s(M)?(i(),d("div",Wt,[t("div",Xt,[e[33]||(e[33]=t("span",{class:"text-sm font-medium"},"Uploading files...",-1)),t("span",Yt,m(s(ze)),1)]),t("div",Zt,[t("div",{class:"bg-primary h-2 rounded-full transition-all duration-300",style:Tt({width:s(dt)+"%"})},null,4)])])):v("",!0),s(y)?(i(),d("div",es,[t("div",ts,[a(n,{name:"lucide:loader-2",class:"h-8 w-8 animate-spin"}),e[34]||(e[34]=t("p",null,"Loading files...",-1))])])):s(q)?(i(),d("div",ss,[t("div",ls,[a(n,{name:"lucide:alert-circle",class:"h-8 w-8"}),e[36]||(e[36]=t("p",{class:"font-medium"},"Failed to load files",-1)),t("p",as,m(s(q)),1),a(u,{variant:"outline",size:"sm",onClick:e[4]||(e[4]=o=>s(R)(s(k))),class:"mt-2"},{default:r(()=>[a(n,{name:"lucide:refresh-cw",class:"mr-2 h-4 w-4"}),e[35]||(e[35]=f(" Retry ",-1))]),_:1})])])):s(C).length===0?(i(),d("div",{key:3,class:z(["rounded-md border-2 border-dashed bg-card p-12 transition-colors",s(J)?"border-primary bg-primary/5":"border-muted"])},[t("div",os,[a(n,{name:"lucide:folder-open",class:"h-16 w-16"}),e[38]||(e[38]=t("p",{class:"font-medium text-lg"},"This folder is empty",-1)),e[39]||(e[39]=t("p",{class:"text-sm"},"Drag and drop files here, or click the Upload button",-1)),a(u,{variant:"outline",size:"sm",class:"mt-2",onClick:Ue},{default:r(()=>[a(n,{name:"lucide:upload",class:"mr-2 h-4 w-4"}),e[37]||(e[37]=f(" Upload Files ",-1))]),_:1})])],2)):(i(),d("div",ns,[a(zt,null,{default:r(()=>[a(Ft,null,{default:r(()=>[a(de,{class:"hover:bg-transparent"},{default:r(()=>[a(U,{class:"w-[40px] px-2 md:px-4"},{default:r(()=>[t("input",{type:"checkbox",checked:s(_e),onChange:e[5]||(e[5]=o=>s(_e)?s(B)():s(D)()),class:"h-4 w-4 rounded border-muted-foreground"},null,40,is)]),_:1}),a(U,{class:"min-w-[200px]"},{default:r(()=>[...e[40]||(e[40]=[f("Name",-1)])]),_:1}),a(U,{class:"hidden md:table-cell"},{default:r(()=>[...e[41]||(e[41]=[f("Type",-1)])]),_:1}),a(U,{class:"hidden md:table-cell"},{default:r(()=>[...e[42]||(e[42]=[f("Size",-1)])]),_:1}),a(U,{class:"text-right hidden md:table-cell"},{default:r(()=>[...e[43]||(e[43]=[f("Modified",-1)])]),_:1}),a(U,{class:"w-[100px]"})]),_:1})]),_:1}),a(Dt,null,{default:r(()=>[(i(!0),d(I,null,N(s(C),o=>(i(),g(de,{key:o.id,class:z("group cursor-pointer select-none transition-colors "+(s(x)(o.id)?"bg-primary/10":"hover:bg-accent/50")),onClick:h=>at(o)},{default:r(()=>[a(H,{class:"px-2 md:px-4",onClick:e[6]||(e[6]=F(()=>{},["stop"]))},{default:r(()=>[t("input",{type:"checkbox",checked:s(x)(o.id),onChange:h=>s(p)(o.id),class:"h-4 w-4 rounded border-muted-foreground accent-primary"},null,40,rs)]),_:2},1024),a(H,{class:"font-medium flex items-center gap-3 py-3 px-2 md:px-4"},{default:r(()=>[t("div",{class:z(["p-2 rounded-lg shrink-0 transition-colors",s(st)(o)])},[a(n,{name:s(tt)(o),class:z(["h-5 w-5",o.type==="folder"?"fill-current":""])},null,8,["name","class"])],2),t("div",ds,[t("span",us,m(o.name),1),t("span",cs,[t("span",null,m(o.type==="folder"?"Folder":s(ke)(o.size)),1),e[44]||(e[44]=t("span",{class:"text-muted-foreground/40"},"â€¢",-1)),t("span",null,m(s(Ce)(o.modified)),1)])])]),_:2},1024),a(H,{class:"text-muted-foreground hidden md:table-cell"},{default:r(()=>{var h;return[f(m(o.type==="folder"?"Folder":((h=o.extension)==null?void 0:h.toUpperCase())||"File"),1)]}),_:2},1024),a(H,{class:"text-muted-foreground hidden md:table-cell"},{default:r(()=>[f(m(s(ke)(o.size)),1)]),_:2},1024),a(H,{class:"text-right text-muted-foreground hidden md:table-cell"},{default:r(()=>[f(m(s(Ce)(o.modified)),1)]),_:2},1024),a(H,{class:"text-right",onClick:e[7]||(e[7]=F(()=>{},["stop"]))},{default:r(()=>[t("div",ms,[o.type==="file"?(i(),g(u,{key:0,variant:"ghost",size:"icon",class:"h-8 w-8 text-blue-600 hover:text-blue-700",onClick:h=>_t(o),title:"Share"},{default:r(()=>[a(n,{name:"lucide:share-2",class:"h-4 w-4"})]),_:1},8,["onClick"])):v("",!0),a(u,{variant:"ghost",size:"icon",class:"h-8 w-8",onClick:h=>ct(o),title:"Rename"},{default:r(()=>[a(n,{name:"lucide:pencil",class:"h-4 w-4"})]),_:1},8,["onClick"]),a(u,{variant:"ghost",size:"icon",class:"h-8 w-8 text-destructive hover:text-destructive",onClick:h=>mt(o),title:"Delete"},{default:r(()=>[a(n,{name:"lucide:trash-2",class:"h-4 w-4"})]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})])),t("div",fs,[a(n,{name:"lucide:info",class:"inline h-3 w-3 mr-1"}),e[45]||(e[45]=f(" Tip: Drag and drop files anywhere to upload. Use checkboxes for bulk actions. ",-1))]),(i(),g(K,{to:"body"},[s(Q)?(i(),d("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:e[10]||(e[10]=F(o=>Q.value=!1,["self"]))},[t("div",ps,[e[48]||(e[48]=t("h2",{class:"text-lg font-semibold mb-4"},"Create New Folder",-1)),t("div",vs,[a(Me,{modelValue:s(P),"onUpdate:modelValue":e[8]||(e[8]=o=>ce(P)?P.value=o:null),placeholder:"Folder name",onKeyup:Ee(Se,["enter"]),autofocus:""},null,8,["modelValue"]),t("div",gs,[a(u,{variant:"outline",class:"flex-1",onClick:e[9]||(e[9]=o=>Q.value=!1)},{default:r(()=>[...e[46]||(e[46]=[f(" Cancel ",-1)])]),_:1}),a(u,{class:"flex-1",disabled:!s(P)||s(ee),onClick:Se},{default:r(()=>[s(ee)?(i(),g(n,{key:0,name:"lucide:loader-2",class:"mr-2 h-4 w-4 animate-spin"})):v("",!0),e[47]||(e[47]=f(" Create ",-1))]),_:1},8,["disabled"])])])])])):v("",!0)])),(i(),g(K,{to:"body"},[s(W)?(i(),d("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:e[13]||(e[13]=F(o=>W.value=!1,["self"]))},[t("div",xs,[e[51]||(e[51]=t("h2",{class:"text-lg font-semibold mb-4"},"Rename",-1)),t("div",hs,[a(Me,{modelValue:s(S),"onUpdate:modelValue":e[11]||(e[11]=o=>ce(S)?S.value=o:null),placeholder:"New name",onKeyup:Ee(je,["enter"]),autofocus:""},null,8,["modelValue"]),t("div",bs,[a(u,{variant:"outline",class:"flex-1",onClick:e[12]||(e[12]=o=>W.value=!1)},{default:r(()=>[...e[49]||(e[49]=[f(" Cancel ",-1)])]),_:1}),a(u,{class:"flex-1",disabled:!s(S)||s(se),onClick:je},{default:r(()=>[s(se)?(i(),g(n,{key:0,name:"lucide:loader-2",class:"mr-2 h-4 w-4 animate-spin"})):v("",!0),e[50]||(e[50]=f(" Rename ",-1))]),_:1},8,["disabled"])])])])])):v("",!0)])),(i(),g(K,{to:"body"},[s(L)?(i(),d("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:e[15]||(e[15]=F(o=>L.value=!1,["self"]))},[t("div",ys,[t("h2",ws,"Move "+m(s(T).size)+" items to...",1),t("div",_s,[t("div",ks,[t("div",Cs,[s(A)?(i(),g(u,{key:0,variant:"ghost",size:"icon",class:"h-7 w-7",onClick:vt},{default:r(()=>[a(n,{name:"lucide:arrow-left",class:"h-4 w-4"})]),_:1})):v("",!0),t("span",$s,m(s(A)||"Root"),1)]),s(pe)?(i(),d("div",Fs,[a(n,{name:"lucide:loader-2",class:"h-5 w-5 animate-spin mx-auto"})])):s(fe).length===0?(i(),d("div",Ds," No folders here ")):(i(),d("div",zs,[(i(!0),d(I,null,N(s(fe),o=>(i(),d("button",{key:o.id,onClick:h=>pt(o.path),class:"w-full flex items-center gap-3 px-3 py-2 hover:bg-muted transition-colors text-left"},[a(n,{name:"lucide:folder",class:"h-4 w-4 text-yellow-600 fill-current"}),t("span",Ts,m(o.name),1),a(n,{name:"lucide:chevron-right",class:"h-4 w-4 text-muted-foreground ml-auto"})],8,Us))),128))]))]),t("div",Ss,[a(u,{variant:"outline",class:"flex-1",onClick:e[14]||(e[14]=o=>L.value=!1)},{default:r(()=>[...e[52]||(e[52]=[f(" Cancel ",-1)])]),_:1}),a(u,{class:"flex-1",disabled:s(le),onClick:gt},{default:r(()=>[s(le)?(i(),g(n,{key:0,name:"lucide:loader-2",class:"mr-2 h-4 w-4 animate-spin"})):v("",!0),e[53]||(e[53]=f(" Move Here ",-1))]),_:1},8,["disabled"])])])])])):v("",!0)])),(i(),g(K,{to:"body"},[s(O)?(i(),d("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:e[17]||(e[17]=F(o=>O.value=!1,["self"]))},[t("div",js,[t("h2",Is,"Copy "+m(s(T).size)+" items to...",1),t("div",Ms,[t("div",Ps,[t("div",As,[s(E)?(i(),g(u,{key:0,variant:"ghost",size:"icon",class:"h-7 w-7",onClick:bt},{default:r(()=>[a(n,{name:"lucide:arrow-left",class:"h-4 w-4"})]),_:1})):v("",!0),t("span",Es,m(s(E)||"Root"),1)]),s(xe)?(i(),d("div",Ns,[a(n,{name:"lucide:loader-2",class:"h-5 w-5 animate-spin mx-auto"})])):s(ge).length===0?(i(),d("div",Bs," No folders here ")):(i(),d("div",Rs,[(i(!0),d(I,null,N(s(ge),o=>(i(),d("button",{key:o.id,onClick:h=>ht(o.path),class:"w-full flex items-center gap-3 px-3 py-2 hover:bg-muted transition-colors text-left"},[a(n,{name:"lucide:folder",class:"h-4 w-4 text-yellow-600 fill-current"}),t("span",Ls,m(o.name),1),a(n,{name:"lucide:chevron-right",class:"h-4 w-4 text-muted-foreground ml-auto"})],8,Vs))),128))]))]),t("div",Os,[a(u,{variant:"outline",class:"flex-1",onClick:e[16]||(e[16]=o=>O.value=!1)},{default:r(()=>[...e[54]||(e[54]=[f(" Cancel ",-1)])]),_:1}),a(u,{class:"flex-1",disabled:s(ae),onClick:yt},{default:r(()=>[s(ae)?(i(),g(n,{key:0,name:"lucide:loader-2",class:"mr-2 h-4 w-4 animate-spin"})):v("",!0),e[55]||(e[55]=f(" Copy Here ",-1))]),_:1},8,["disabled"])])])])])):v("",!0)])),(i(),g(K,{to:"body"},[s(Y)?(i(),d("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:e[20]||(e[20]=F(o=>Y.value=!1,["self"]))},[t("div",Hs,[t("h2",Ks,[a(n,{name:"lucide:share-2",class:"h-5 w-5 text-blue-600"}),e[56]||(e[56]=f(" Share File ",-1))]),s(be)?(i(),d("div",qs,[a(n,{name:"lucide:loader-2",class:"h-8 w-8 animate-spin"}),e[57]||(e[57]=t("p",null,"Checking active links...",-1))])):s($)?(i(),d("div",Zs,[t("div",{class:z(["flex items-center gap-2",s($).isExisting?"text-blue-600":"text-green-600"])},[a(n,{name:s($).isExisting?"lucide:link":"lucide:check-circle",class:"h-5 w-5"},null,8,["name"]),t("span",el,m(s($).isExisting?"Active Link Found":"Link created!"),1)],2),t("div",tl,[t("input",{type:"text",value:s($).url,readonly:"",class:"flex-1 px-3 py-2 bg-muted border rounded-md text-sm"},null,8,sl),a(u,{onClick:$t,variant:s(ie)?"default":"outline"},{default:r(()=>[a(n,{name:s(ie)?"lucide:check":"lucide:copy",class:"h-4 w-4"},null,8,["name"])]),_:1},8,["variant"])]),t("p",ll," Expires: "+m(new Date(s($).expiresAt).toLocaleString()),1),a(u,{class:"w-full",onClick:e[19]||(e[19]=o=>Y.value=!1)},{default:r(()=>[...e[61]||(e[61]=[f(" Done ",-1)])]),_:1})])):(i(),d("div",Js,[t("div",Gs,[t("span",Qs,m((Pe=s(j))==null?void 0:Pe.name),1)]),t("div",null,[e[58]||(e[58]=t("label",{class:"text-sm text-muted-foreground mb-2 block"},"Link expires in:",-1)),t("div",Ws,[(i(),d(I,null,N(wt,o=>t("button",{key:o.label,onClick:h=>{oe.value=o.days,re.value=o.unit},class:z(["px-3 py-2 rounded-lg text-sm font-medium transition-all border",s(oe)===o.days&&s(re)===o.unit?"bg-primary text-primary-foreground border-primary":"bg-background border-border hover:bg-muted"])},m(o.label),11,Xs)),64))])]),t("div",Ys,[a(u,{variant:"outline",class:"flex-1",onClick:e[18]||(e[18]=o=>Y.value=!1)},{default:r(()=>[...e[59]||(e[59]=[f(" Cancel ",-1)])]),_:1}),a(u,{class:"flex-1",disabled:s(ne),onClick:Ct},{default:r(()=>[s(ne)?(i(),g(n,{key:0,name:"lucide:loader-2",class:"mr-2 h-4 w-4 animate-spin"})):v("",!0),e[60]||(e[60]=f(" Create Link ",-1))]),_:1},8,["disabled"])])]))])])):v("",!0)])),(i(),g(K,{to:"body"},[s(b).isOpen?(i(),d("div",al,[t("div",ol,[t("div",nl,[t("div",il,[a(n,{name:"lucide:alert-triangle",class:"h-5 w-5 text-destructive"})]),t("h3",rl,m(s(b).title),1)]),t("p",dl,m(s(b).message),1),t("div",ul,[t("button",{onClick:e[21]||(e[21]=o=>{s(b).resolve(!1),s(b).isOpen=!1}),class:"px-4 py-2 rounded-md text-sm font-medium border border-input bg-background hover:bg-muted transition-colors"}," Cancel "),t("button",{onClick:e[22]||(e[22]=o=>{s(b).resolve(!0),s(b).isOpen=!1}),class:"px-4 py-2 rounded-md text-sm font-medium bg-destructive text-destructive-foreground hover:bg-destructive/90 transition-colors"},m(s(b).confirmText),1)])])])):v("",!0)]))],32)}}}),ml=Oe(cl,[["__scopeId","data-v-2f3a6345"]]),fl={class:"h-[calc(100vh-8rem)] flex flex-col gap-4"},pl={class:"flex-1 grid grid-cols-1 lg:grid-cols-2 gap-4 min-h-0"},vl={class:"flex flex-col border rounded-lg bg-card shadow-sm overflow-hidden"},gl={class:"p-3 border-b bg-muted/30 flex items-center justify-between gap-3"},xl={class:"flex items-center gap-2 flex-1 min-w-0"},hl={class:"p-1.5 rounded bg-primary/10 shrink-0"},bl=["value"],yl={class:"text-xs text-muted-foreground whitespace-nowrap hidden sm:block"},wl={class:"flex-1 overflow-y-auto p-4 custom-scrollbar"},_l={key:1,class:"h-full flex flex-col items-center justify-center text-muted-foreground"},kl={class:"flex flex-col border rounded-lg bg-card shadow-sm overflow-hidden"},Cl={class:"p-3 border-b bg-muted/30 flex items-center justify-between gap-3"},$l={class:"flex items-center gap-2 flex-1 min-w-0"},Fl={class:"p-1.5 rounded bg-secondary/10 shrink-0"},Dl=["value"],zl={class:"text-xs text-muted-foreground whitespace-nowrap hidden sm:block"},Ul={class:"flex-1 overflow-y-auto p-4 custom-scrollbar"},Tl={key:1,class:"h-full flex flex-col items-center justify-center text-muted-foreground"},Sl=Re({__name:"split",setup(we){const{accounts:_,activeAccountId:k}=He(),C=c(k.value),y=c(""),q=ue(()=>[..._.value].sort((w,p)=>(w.name||"").localeCompare(p.name||"")));Ve(()=>{var w;if(_.value.length>1){const p=_.value.find(D=>D.id!==C.value);p?y.value=p.id:y.value=((w=_.value[0])==null?void 0:w.id)||""}else _.value.length===1&&(y.value=_.value[0].id)});const T=w=>{const p=_.value.find(D=>D.id===w);return(p==null?void 0:p.email)||""};return(w,p)=>{const D=Le,B=ml;return i(),d("div",fl,[p[5]||(p[5]=t("div",{class:"flex items-center justify-between"},[t("h1",{class:"text-2xl font-semibold tracking-tight"},"Split View"),t("p",{class:"text-sm text-muted-foreground hidden md:block"}," Manage files across two accounts simultaneously ")],-1)),t("div",pl,[t("div",vl,[t("div",gl,[t("div",xl,[t("div",hl,[a(D,{name:"lucide:layout-panel-left",class:"h-4 w-4 text-primary"})]),Ne(t("select",{"onUpdate:modelValue":p[0]||(p[0]=x=>ce(C)?C.value=x:null),class:"flex-1 min-w-0 bg-transparent text-sm font-medium focus:outline-none cursor-pointer hover:bg-muted/50 rounded py-1 pl-1 pr-8","aria-label":"Select Account for Left Pane"},[(i(!0),d(I,null,N(s(q),x=>(i(),d("option",{key:x.id,value:x.id},m(x.name||x.email),9,bl))),128))],512),[[Be,s(C)]])]),t("div",yl,m(T(s(C))),1)]),t("div",wl,[s(C)?(i(),g(B,{"account-id":s(C),key:`left-${s(C)}`},null,8,["account-id"])):(i(),d("div",_l,[a(D,{name:"lucide:user-x",class:"h-12 w-12 mb-2 opacity-50"}),p[2]||(p[2]=t("p",null,"No account selected",-1))]))])]),t("div",kl,[t("div",Cl,[t("div",$l,[t("div",Fl,[a(D,{name:"lucide:layout-panel-left",class:"h-4 w-4 text-secondary-foreground rotate-180"})]),Ne(t("select",{"onUpdate:modelValue":p[1]||(p[1]=x=>ce(y)?y.value=x:null),class:"flex-1 min-w-0 bg-transparent text-sm font-medium focus:outline-none cursor-pointer hover:bg-muted/50 rounded py-1 pl-1 pr-8","aria-label":"Select Account for Right Pane"},[p[3]||(p[3]=t("option",{value:"",disabled:""},"Select Account",-1)),(i(!0),d(I,null,N(s(q),x=>(i(),d("option",{key:x.id,value:x.id},m(x.name||x.email),9,Dl))),128))],512),[[Be,s(y)]])]),t("div",zl,m(T(s(y))),1)]),t("div",Ul,[s(y)?(i(),g(B,{"account-id":s(y),key:`right-${s(y)}`},null,8,["account-id"])):(i(),d("div",Tl,[a(D,{name:"lucide:arrow-left-right",class:"h-12 w-12 mb-2 opacity-50"}),p[4]||(p[4]=t("p",null,"Select an account to compare",-1))]))])])])])}}}),Ll=Oe(Sl,[["__scopeId","data-v-e7b78dfc"]]);export{Ll as default};
