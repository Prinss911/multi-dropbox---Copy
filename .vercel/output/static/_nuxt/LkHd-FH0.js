import{d as U,H as G,g as H,B as K,r as y,h as P,i as R,c as r,b as d,w as f,o as i,f as l,a as e,_ as q,t as a,s as M,l as T,F as _,e as b,k,x as v,A as J}from"./D0_loxAU.js";import{_ as Q}from"./2t6NhyjD.js";import{_ as W}from"./Mvjefoez.js";import{_ as X}from"./kecAHLyk.js";import"./oVxJKGu7.js";import"./BNf5BS2b.js";const Y={class:"h-full flex flex-col bg-background/50"},Z={key:0,class:"h-full flex items-center justify-center"},ee={class:"flex flex-col items-center gap-3"},te={key:1,class:"flex-1 overflow-auto"},se={class:"sticky top-0 z-20 bg-background/95 backdrop-blur border-b px-6 py-4"},oe={class:"w-full"},ne={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},de={class:"flex items-center gap-6"},le={class:"flex items-center gap-3"},ae={class:"h-10 w-10 rounded-full bg-green-50 flex items-center justify-center text-green-600 shrink-0"},re={class:"text-right sm:text-left"},ie={class:"text-sm font-semibold text-[#1E1919] dark:text-foreground"},ce={class:"flex items-center gap-3"},ue={class:"h-10 w-10 rounded-full bg-purple-50 flex items-center justify-center text-purple-600 shrink-0"},me={class:"text-sm font-semibold text-[#1E1919] dark:text-foreground"},xe={class:"text-xs text-muted-foreground"},fe={class:"px-4 md:px-6 py-8 w-full space-y-8"},pe={key:0,class:"py-12 flex justify-center text-muted-foreground"},ge={class:"flex flex-col items-center gap-2"},he={key:1,class:"p-6 rounded-lg bg-red-50 border border-red-100 text-center text-red-600"},_e={class:"text-sm opacity-80 mt-1"},be={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ve={class:"bg-card rounded-xl border p-6 shadow-sm"},we={class:"font-semibold text-base mb-6 flex items-center gap-2"},ye={class:"space-y-4"},ke={class:"flex items-center justify-between mb-2 text-sm"},Ee={class:"flex items-center gap-2"},Ce={class:"font-medium text-[#1E1919] dark:text-foreground"},Fe={class:"text-muted-foreground font-mono text-xs"},De={class:"h-2 w-full bg-muted/50 rounded-full overflow-hidden"},Be={class:"bg-card rounded-xl border p-6 shadow-sm flex flex-col"},Ne={class:"font-semibold text-base mb-6 flex items-center gap-2"},je={key:0,class:"flex-1 flex flex-col items-center justify-center text-muted-foreground py-10"},Se={key:1,class:"space-y-1"},Ae={class:"text-sm font-bold text-muted-foreground/50 w-4"},Me={class:"h-8 w-8 rounded bg-blue-50 flex items-center justify-center text-[#0061FE] shrink-0"},Te={class:"flex-1 min-w-0"},Le=["title"],ze={class:"text-xs text-muted-foreground"},Ie={class:"text-sm font-medium bg-muted/50 px-2 py-1 rounded text-muted-foreground"},$e={class:"bg-card rounded-xl border shadow-sm overflow-hidden"},Ve={class:"px-6 py-5 border-b flex items-center justify-between"},Oe={class:"overflow-x-auto"},Ue={class:"w-full text-left"},Ge={class:"divide-y divide-border/50"},He={key:0},Ke={class:"px-6 py-3"},Pe={class:"flex items-center gap-3"},Re={class:"text-sm font-medium text-[#1E1919] dark:text-foreground truncate max-w-[200px]"},qe={class:"px-6 py-3 text-sm text-muted-foreground hidden sm:table-cell"},Je={class:"truncate max-w-[120px]"},Qe={class:"px-6 py-3 text-sm text-muted-foreground hidden md:table-cell"},We={class:"px-6 py-3"},Xe={class:"px-6 py-3 text-right text-sm font-mono text-muted-foreground"},Ye={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Ze={class:"h-10 w-10 rounded-full bg-blue-50 text-[#0061FE] flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform"},et={class:"h-10 w-10 rounded-full bg-orange-50 text-orange-600 flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform"},tt={class:"h-10 w-10 rounded-full bg-purple-50 text-purple-600 flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform"},st={class:"h-10 w-10 rounded-full bg-slate-50 text-slate-600 flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform"},ot={class:"h-full flex items-center justify-center"},nt={class:"flex flex-col items-center gap-3"},mt=U({__name:"index",setup(dt){const{isAdmin:E,role:C}=G();H(()=>C.value===null);const L=K(),c=y(null),p=y(!1),h=y(null),F=async()=>{if(E.value){p.value=!0,h.value=null;try{const{data:{session:o}}=await L.auth.getSession();if(!(o!=null&&o.access_token))throw new Error("Not authenticated");const t=await $fetch("/api/admin/dashboard",{headers:{Authorization:`Bearer ${o.access_token}`}});c.value=t}catch(o){console.error("Dashboard fetch error:",o),h.value=o}finally{p.value=!1}}},z=()=>F();P(()=>{R(C,async o=>{o==="admin"?await F():o!==null&&await J("/drive/files",{replace:!0})},{immediate:!0})});const x=["#0061FE","#0070E0","#007EE5","#248CF2","#4D9BF7","#76ABFC"],w=(o,t)=>{var m;if(!o&&!t)return x[0];let s=-1;return(m=c.value)!=null&&m.accounts&&(o&&(s=c.value.accounts.findIndex(u=>u.id===o)),s===-1&&t&&(s=c.value.accounts.findIndex(u=>u.name===t))),s===-1?x[0]:x[s%x.length]},D=o=>{if(o===0)return"0 B";const t=1024,s=["B","KB","MB","GB","TB"],m=Math.floor(Math.log(o)/Math.log(t));return parseFloat((o/Math.pow(t,m)).toFixed(1))+" "+s[m]},I=o=>new Date(o).toLocaleDateString("id-ID",{day:"numeric",month:"short"}),$=o=>{if(!o)return"Never";const t=new Date(o),s=new Date;if(t<=s)return"Expired";const m=t.getTime()-s.getTime(),u=Math.floor(m/(1e3*60*60*24));return u>0?`In ${u} days`:"Today"},V=o=>{if(!o)return"bg-emerald-100 text-emerald-700 dark:bg-emerald-500/20 dark:text-emerald-400";const t=new Date(o),s=new Date;if(t<=s)return"bg-red-100 text-red-700 dark:bg-red-500/20 dark:text-red-400";const m=t.getTime()-s.getTime();return Math.floor(m/(1e3*60*60*24))<3?"bg-amber-100 text-amber-700 dark:bg-amber-500/20 dark:text-amber-400":"bg-blue-100 text-blue-700 dark:bg-blue-500/20 dark:text-blue-400"};return(o,t)=>{const s=q,m=Q,u=W,O=X;return i(),r("div",Y,[d(O,null,{fallback:f(()=>[e("div",ot,[e("div",nt,[d(s,{name:"lucide:loader-2",class:"animate-spin h-8 w-8 text-[#0061FE]"}),t[18]||(t[18]=e("p",{class:"text-sm text-muted-foreground"},"Loading...",-1))])])]),default:f(()=>{var B,N,j,S,A;return[l(E)?(i(),r("div",te,[e("div",se,[e("div",oe,[e("div",ne,[t[3]||(t[3]=e("div",null,[e("h1",{class:"text-xl font-semibold text-[#1E1919] dark:text-foreground"},"Overview"),e("p",{class:"text-sm text-muted-foreground"},"Admin Dashboard")],-1)),e("div",de,[e("div",le,[e("div",ae,[d(s,{name:"lucide:users",class:"h-5 w-5"})]),e("div",re,[e("p",ie,a(((B=l(c))==null?void 0:B.accountCount)||0)+" Accounts",1),t[1]||(t[1]=e("p",{class:"text-xs text-muted-foreground"},"Connected",-1))])]),t[2]||(t[2]=e("div",{class:"w-px h-8 bg-border hidden sm:block"},null,-1)),e("div",ce,[e("div",ue,[d(s,{name:"lucide:link",class:"h-5 w-5"})]),e("div",null,[e("p",me,a(((j=(N=l(c))==null?void 0:N.shares)==null?void 0:j.active)||0)+" Active Links",1),e("p",xe,a(((A=(S=l(c))==null?void 0:S.shares)==null?void 0:A.totalDownloads)||0)+" Total Downloads",1)])])]),d(m,{variant:"ghost",size:"icon",onClick:z,disabled:l(p),class:"ml-4"},{default:f(()=>[d(s,{name:l(p)?"lucide:loader-2":"lucide:refresh-cw",class:M([{"animate-spin":l(p)},"h-4 w-4"])},null,8,["name","class"])]),_:1},8,["disabled"])])])]),e("div",fe,[l(p)?(i(),r("div",pe,[e("div",ge,[d(s,{name:"lucide:loader-2",class:"animate-spin h-8 w-8 text-[#0061FE]"}),t[4]||(t[4]=e("p",{class:"text-sm"},"Loading dashboard data...",-1))])])):l(h)?(i(),r("div",he,[d(s,{name:"lucide:alert-triangle",class:"h-8 w-8 mb-2 mx-auto"}),t[5]||(t[5]=e("p",{class:"font-medium"},"Failed to load dashboard data",-1)),e("p",_e,a(l(h).message),1)])):l(c)?(i(),r(_,{key:2},[e("div",be,[e("div",ve,[e("h3",we,[d(s,{name:"lucide:pie-chart",class:"h-4 w-4 text-muted-foreground"}),t[6]||(t[6]=b(" Storage Breakdown ",-1))]),e("div",ye,[(i(!0),r(_,null,k(l(c).accounts,(n,g)=>(i(),r("div",{key:n.id,class:"group"},[e("div",ke,[e("div",Ee,[e("div",{class:"w-2.5 h-2.5 rounded-full shrink-0",style:v({backgroundColor:x[g%x.length]})},null,4),e("span",Ce,a(n.name),1)]),e("div",Fe,a(D(n.used))+" / "+a(D(n.allocated)),1)]),e("div",De,[e("div",{class:"h-full rounded-full transition-all duration-500",style:v({backgroundColor:x[g%x.length],width:`${n.allocated>0?n.used/n.allocated*100:0}%`})},null,4)])]))),128))])]),e("div",Be,[e("h3",Ne,[d(s,{name:"lucide:trending-up",class:"h-4 w-4 text-muted-foreground"}),t[7]||(t[7]=b(" Popular Files ",-1))]),l(c).topDownloaded.length===0?(i(),r("div",je,[d(s,{name:"lucide:bar-chart-2",class:"h-10 w-10 opacity-20 mb-3"}),t[8]||(t[8]=e("p",{class:"text-sm"},"No download data available yet",-1))])):(i(),r("div",Se,[(i(!0),r(_,null,k(l(c).topDownloaded,(n,g)=>(i(),r("div",{key:g,class:"flex items-center gap-4 p-3 rounded-lg hover:bg-muted/30 transition-colors"},[e("span",Ae,a(g+1),1),e("div",Me,[d(s,{name:"lucide:file",class:"h-4 w-4"})]),e("div",Te,[e("p",{class:"text-sm font-medium truncate text-[#1E1919] dark:text-foreground",title:n.fileName},a(n.fileName),9,Le),e("p",ze,a(n.accountName),1)]),e("div",Ie,a(n.downloads)+" â†“ ",1)]))),128))]))])]),e("div",$e,[e("div",Ve,[t[10]||(t[10]=e("h3",{class:"font-semibold text-base"},"Recent Share Links",-1)),d(u,{to:"/admin/shares",class:"text-xs font-medium text-[#0061FE] hover:underline flex items-center gap-1"},{default:f(()=>[t[9]||(t[9]=b(" Manage all shares ",-1)),d(s,{name:"lucide:arrow-right",class:"h-3 w-3"})]),_:1})]),e("div",Oe,[e("table",Ue,[t[13]||(t[13]=e("thead",{class:"bg-muted/20"},[e("tr",null,[e("th",{class:"px-6 py-3 text-xs font-semibold text-muted-foreground uppercase tracking-wider"},"File Name"),e("th",{class:"px-6 py-3 text-xs font-semibold text-muted-foreground uppercase tracking-wider hidden sm:table-cell"},"Account"),e("th",{class:"px-6 py-3 text-xs font-semibold text-muted-foreground uppercase tracking-wider hidden md:table-cell"},"Created"),e("th",{class:"px-6 py-3 text-xs font-semibold text-muted-foreground uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider"},"Downloads")])],-1)),e("tbody",Ge,[l(c).recentShares.length===0?(i(),r("tr",He,[...t[11]||(t[11]=[e("td",{colspan:"5",class:"px-6 py-12 text-center text-muted-foreground"}," No share links created yet. ",-1)])])):T("",!0),(i(!0),r(_,null,k(l(c).recentShares,n=>(i(),r("tr",{key:n.id,class:"hover:bg-muted/20 transition-colors group"},[e("td",Ke,[e("div",Pe,[d(s,{name:"lucide:file-text",class:"h-4 w-4 text-muted-foreground"}),e("span",Re,a(n.fileName),1)])]),e("td",qe,[e("span",{class:"inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium whitespace-nowrap",style:v({backgroundColor:w(n.accountId,n.accountName)+"15",color:w(n.accountId,n.accountName)})},[e("span",{class:"w-1.5 h-1.5 rounded-full shrink-0",style:v({backgroundColor:w(n.accountId,n.accountName)})},null,4),e("span",Je,a(n.accountName),1)],4)]),e("td",Qe,a(I(n.createdAt)),1),e("td",We,[e("span",{class:M(["inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium",V(n.expiresAt)])},[t[12]||(t[12]=e("span",{class:"h-1.5 w-1.5 rounded-full bg-current opacity-60"},null,-1)),b(" "+a($(n.expiresAt)),1)],2)]),e("td",Xe,a(n.downloads),1)]))),128))])])])]),e("div",Ye,[d(u,{to:"/drive/upload",class:"bg-card hover:bg-muted/40 p-4 rounded-xl border transition-all text-center group"},{default:f(()=>[e("div",Ze,[d(s,{name:"lucide:upload",class:"h-5 w-5"})]),t[14]||(t[14]=e("p",{class:"font-medium text-sm"},"Upload File",-1))]),_:1}),d(u,{to:"/admin/files",class:"bg-card hover:bg-muted/40 p-4 rounded-xl border transition-all text-center group"},{default:f(()=>[e("div",et,[d(s,{name:"lucide:folder-cog",class:"h-5 w-5"})]),t[15]||(t[15]=e("p",{class:"font-medium text-sm"},"File Manager",-1))]),_:1}),d(u,{to:"/admin/shares",class:"bg-card hover:bg-muted/40 p-4 rounded-xl border transition-all text-center group"},{default:f(()=>[e("div",tt,[d(s,{name:"lucide:share-2",class:"h-5 w-5"})]),t[16]||(t[16]=e("p",{class:"font-medium text-sm"},"Shared Links",-1))]),_:1}),d(u,{to:"/admin/accounts",class:"bg-card hover:bg-muted/40 p-4 rounded-xl border transition-all text-center group"},{default:f(()=>[e("div",st,[d(s,{name:"lucide:settings-2",class:"h-5 w-5"})]),t[17]||(t[17]=e("p",{class:"font-medium text-sm"},"Settings",-1))]),_:1})])],64)):T("",!0)])])):(i(),r("div",Z,[e("div",ee,[d(s,{name:"lucide:loader-2",class:"animate-spin h-8 w-8 text-[#0061FE]"}),t[0]||(t[0]=e("p",{class:"text-sm text-muted-foreground"},"Redirecting...",-1))])]))]}),_:1})])}}});export{mt as default};
